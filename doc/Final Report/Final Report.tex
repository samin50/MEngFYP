\documentclass[12pt, a4paper]{article}
% Packages
\usepackage{xurl}
\usepackage{abstract}
\usepackage{lipsum}
\usepackage{sectsty}
\usepackage{newclude}
\usepackage{tocloft}
\usepackage{graphicx}
\usepackage{float}
\usepackage[hypcap=false, justification=centering]{caption}
\usepackage{titlesec, minitoc}
\usepackage{enumitem}
\usepackage{silence}
\usepackage{multicol}
\usepackage{tabularx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[numbers, comma, sort&compress]{natbib}
\usepackage[a4paper, margin=1.5cm]{geometry}
\usepackage{hyperref}
\usepackage{fancyhdr}
\usepackage{svg}
\usepackage[outputdir=out, newfloat]{minted}
% Font
\usepackage{stix2}
\usepackage{amsmath}

\geometry{top=2cm}
\renewcommand{\cftdotsep}{1}
\renewcommand{\bibsection}{}
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\subsectionautorefname}{Subsection}
\renewcommand{\subsubsectionautorefname}{Subsubsection}
\renewcommand{\figureautorefname}{Figure}
\renewcommand\cftsecleader{\cftdotfill{\cftdotsep}}
\hypersetup{colorlinks=true, urlcolor=blue, linkcolor=blue, citecolor=blue}

% Minted Setup
\newenvironment{code}{\captionsetup{type=listing}}{}
\SetupFloatingEnvironment{listing}{name=Code Snippet}
\definecolor{bg}{rgb}{0.95,0.95,0.95}
% Texttt colouring
\let\oldtexttt\texttt
\renewcommand{\texttt}[1]{
  \colorbox{bg}{
    \oldtexttt{#1}
  }%
}

% Todo notes
\presetkeys{todonotes}{inline}{
  backgroundcolor=red!20,
}
% \hbadness=99999 
% List spacing - https://tex.stackexchange.com/questions/10684/vertical-space-in-lists
\newenvironment{mylist}
{ \vspace{-0.5em}
   \begin{itemize}[leftmargin=2em]
    \setlength{\itemsep}{0pt}
    \setlength{\parskip}{0pt}
}{ 
  \end{itemize}
}
% Fancy headers
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\textsc{A Vision-Assisted Mechatronic Component Sorter}} 
\fancyhead[R]{\textsc{Shaheen Amin}}
\renewcommand{\headrulewidth}{0.2pt}
\setlength{\headheight}{15pt}
\setlength {\marginparwidth}{2cm}
\fancyfoot[C]{\thepage}

% Adjusting space
\titlespacing*{\section}{0pt}{1em}{1em}
\titlespacing*{\subsection}{0pt}{1em}{0.5em}
\titlespacing*{\subsubsection}{0pt}{1em}{0.5em}
% Set paragraph indentation to zero to prevent automatic indents
\setlength{\parindent}{0pt}
% Set space between paragraphs
\setlength{\parskip}{0.5em}  % Adjust the space to suit your needs

% Adjusting font size
\sectionfont{\fontsize{21}{15}\selectfont}
\subsectionfont{\fontsize{16}{15}\selectfont}
\subsubsectionfont{\fontsize{14}{15}\selectfont}

% Adjusting contents space
\setlength{\cftbeforesecskip}{1pt}
\setlength{\cftbeforesubsecskip}{1pt}
\setlength{\cftaftertoctitleskip}{4pt}
\dosecttoc

% Rename the section command
\setcounter{secttocdepth}{3}
% Set up right-aligned section titles with a custom right space
\titleformat{\section}
  {\normalfont\Huge\bfseries\raggedleft} % Right-aligned, bold, large font
  {\thesection} % The section number
  {1em} % Space between number and text
  {\textsc} % Adding horizontal space on the left
\let\oldsection\section
\renewcommand\section[1]{
  \pagebreak\
  \oldsection{#1}
  {\hypersetup{hidelinks}\secttoc\thispagestyle{fancy}}
}

% Document
\begin{document}
% Title
\begin{titlepage}
  % Logo
  \noindent
  \includegraphics[width=80mm]{imgs/icl_logo.png}

  % Title
  \centering
  \vspace{3.5cm}

  \rule{\textwidth}{0.5pt}
  \huge \textsc{A Vision-Assisted\\Mechatronic Component Sorter}
  \rule{\textwidth}{0.5pt}

  \vspace{1cm}
  \LARGE \textsc{MEng Final Year Report}
  
  \vspace{3cm}
  \large  Author\\
  \Large  \textsc{Shaheen Amin}\\
  \Large CID: 01866464\\

  \vspace{1.5cm}
  \large Supervised by\\
  \Large \textsc{Dr. E. Stott}\\
  \Large \textsc{Dr. T. Constandinou}\\

  \vfill
  \normalsize
  A thesis submitted in fulfilment of requirements for the degree of\\
  \textbf{Master of Electronics and Information Engineering}\\
  
  \vspace{0.5cm}
  \normalsize
  Department of Electrical and Electronic Engineering\\
  Imperial College London\\
  2024
  \vspace{1cm}
\end{titlepage}

% Plagirism Declaration
\newpage
\vspace*{\fill}
\begin{center}
  \large\textsc{Plagiarism Declaration}\\
\end{center}
\noindent I affirm that I have submitted, or will submit, an electronic copy of my final year project report to the provided EEE link.\\
\noindent I affirm that I have submitted, or will submit, an identical electronic copy of my final year project to the provided Blackboard module for Plagiarism checking.\\
\noindent I affirm that I have provided explicit references for all the material in my Final Report that is not authored by me but is represented as my work.\\
\noindent I have used GPTv4, as an aid in the preparation of my report. GPTv4 was used for LaTeX formatting and spellchecking, however, all technical content is original.\\
\vspace*{\fill}

% Abstract
\newpage
\vspace*{\fill}
\begin{center}
  \large\textsc{Abstract} \\
\end{center}
\noindent To address the issue of electronic waste and cluttered workspaces in the Level 1 Labs, this project aims to develop an automated system for identifying and sorting electronic components. Utilising Computer Vision techniques, the system will classify electrical components such as resistors, capacitors, LEDs and inductors, and sort them into designated bins. The project consists of three core components: the mechanical design of the system, the integration of electronics and software, and the development of a Computer Vision system. This project aims to efficiently resolve these issues. \\
\vspace*{\fill}

% Acknowledgements
\newpage
\vspace*{\fill}
\begin{center}
  \large\textsc{Acknowledgements} \\
\end{center}
\noindent I would like to thank my parents, who have done nothing but support me throughout my academic journey. Their sacrifices have enabled me and my siblings to pursue our dreams, and I am forever grateful for their unwavering support. \\
I would also like to thank my supervisor, Dr. Ed Stott, for his guidance and expertise when it came to the technical aspects of the project. His insights and feedback have been invaluable in shaping the project into what it is today. \\
Finally, I would like to thank my wonderful friends and classmates, who have all been a source of inspiration and motivation throughout my time at Imperial. Their love and support has truly been a light in the dark, and I am eternally grateful for their presence in my life. \\
\vspace*{\fill}
\newpage

% Contents page
{\hypersetup{hidelinks}\tableofcontents\thispagestyle{fancy}}
% List of todos
\newcommand{\neutralizelistoftodos}{
  \begingroup
  % Redefine \section to simply swallow its argument and do nothing
  \renewcommand{\section}[1]{}
  \newpage
  {\large\textbf{List of Todos}}
  \listoftodos
  \endgroup
}
\neutralizelistoftodos

% Sections
\include*{Project Specification}
% Background
\include*{Background}
% Design and System Architecture
\include*{Design and System Architecture}
% Implementation
\include*{Implementation}
% Results and Evaluation
\include*{Evaluation}
% Testing
\include*{Testing}
% Conclusion and Future Work
\include*{Conclusion}
\section{References}
\bibliographystyle{IEEEtranN}
\bibliography{References}

% Appendices
\include*{Appendix}

\end{document}